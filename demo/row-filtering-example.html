<!DOCTYPE html>
<html>

<head>
    <title>ULabel Row Filtering Example</title>

    <!-- ULabel Library -->
    <script src="/ulabel.js"></script>

    <!-- JQuery Library -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"
        integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

    <!-- ULabel Usage -->
    <script>
        /* global $ */
        /* global ULabel */

        $(window).on("load", function () {

            function on_submit(annotations) {
                var element = document.createElement('a');
                element.setAttribute(
                    "href", ('data:text/plain;charset=utf-8,' +
                        encodeURIComponent(JSON.stringify(annotations, null, 2)))
                );
                element.setAttribute("download", "annotations.json");
                element.style.display = 'none';
                document.body.appendChild(element);
                element.click();
                document.body.removeChild(element);
            }

            const points_resume_from = [
                {
                    "id": "eee51154-7329-4f1b-8582-b9c40525b138",
                    "new": true,
                    "parent_id": null,
                    "created_by": "DemoUser",
                    "created_at": "2023-02-22T00:16:06.483Z",
                    "deprecated": false,
                    "human_deprecated": false,
                    "spatial_type": "point",
                    "spatial_payload": [
                        [
                            133.23102585487908,
                            283.5429524603837
                        ]
                    ],
                    "classification_payloads": [
                        {
                            "class_id": 10,
                            "confidence": 0.21
                        }
                    ],
                    "line_size": 6.831220813875917,
                    "containing_box": {
                        "tlx": 112.73736341325133,
                        "tly": 263.0492900187559,
                        "brx": 153.72468829650683,
                        "bry": 304.0366149020114,
                        "tlz": 0,
                        "brz": 0
                    },
                    "frame": 0,
                    "text_payload": "",
                    "annotation_meta": null
                },
                {
                    "id": "99614384-5855-4141-959a-7acd4f3f8e35",
                    "new": true,
                    "parent_id": null,
                    "created_by": "DemoUser",
                    "created_at": "2023-02-22T00:16:06.909Z",
                    "deprecated": false,
                    "human_deprecated": false,
                    "spatial_type": "point",
                    "spatial_payload": [
                        [
                            391.15262718932445,
                            479.97331109257715
                        ]
                    ],
                    "classification_payloads": [
                        {
                            "class_id": 10,
                            "confidence": 0.51
                        }
                    ],
                    "line_size": 6.831220813875917,
                    "containing_box": {
                        "tlx": 370.6589647476967,
                        "tly": 459.4796486509494,
                        "brx": 411.6462896309522,
                        "bry": 500.4669735342049,
                        "tlz": 0,
                        "brz": 0
                    },
                    "frame": 0,
                    "text_payload": "",
                    "annotation_meta": null
                },
                {
                    "id": "2b3ef5cb-0152-4757-9cbb-36579621b118",
                    "new": true,
                    "parent_id": null,
                    "created_by": "DemoUser",
                    "created_at": "2023-02-22T00:16:07.482Z",
                    "deprecated": false,
                    "human_deprecated": false,
                    "spatial_type": "point",
                    "spatial_payload": [
                        [
                            567.0859049207673,
                            843.7964970809007
                        ]
                    ],
                    "classification_payloads": [
                        {
                            "class_id": 10,
                            "confidence": 0.41
                        }
                    ],
                    "line_size": 6.831220813875917,
                    "containing_box": {
                        "tlx": 546.5922424791396,
                        "tly": 823.302834639273,
                        "brx": 587.5795673623951,
                        "bry": 864.2901595225285,
                        "tlz": 0,
                        "brz": 0
                    },
                    "frame": 0,
                    "text_payload": "",
                    "annotation_meta": null
                },
                {
                    "id": "2ff88660-9e9e-4d7b-8260-b66e3a9fb9d5",
                    "new": true,
                    "parent_id": null,
                    "created_by": "DemoUser",
                    "created_at": "2023-02-22T00:16:08.268Z",
                    "deprecated": false,
                    "human_deprecated": false,
                    "spatial_type": "point",
                    "spatial_payload": [
                        [
                            464.6005004170142,
                            230.59216013344454
                        ]
                    ],
                    "classification_payloads": [
                        {
                            "class_id": 10,
                            "confidence": 0.01
                        }
                    ],
                    "line_size": 6.831220813875917,
                    "containing_box": {
                        "tlx": 444.10683797538644,
                        "tly": 210.0984976918168,
                        "brx": 485.09416285864194,
                        "bry": 251.08582257507229,
                        "tlz": 0,
                        "brz": 0
                    },
                    "frame": 0,
                    "text_payload": "",
                    "annotation_meta": null
                },
                {
                    "id": "8ae007dd-ce9d-4683-9882-2b729228fe29",
                    "new": true,
                    "parent_id": null,
                    "created_by": "DemoUser",
                    "created_at": "2023-02-22T00:16:08.884Z",
                    "deprecated": false,
                    "human_deprecated": false,
                    "spatial_type": "point",
                    "spatial_payload": [
                        [
                            826.7155963302753,
                            227.17597998331942
                        ]
                    ],
                    "classification_payloads": [
                        {
                            "class_id": 10,
                            "confidence": 0.81
                        }
                    ],
                    "line_size": 6.831220813875917,
                    "containing_box": {
                        "tlx": 806.2219338886475,
                        "tly": 206.68231754169167,
                        "brx": 847.209258771903,
                        "bry": 247.66964242494717,
                        "tlz": 0,
                        "brz": 0
                    },
                    "frame": 0,
                    "text_payload": "",
                    "annotation_meta": null
                },
                {
                    "id": "05f92e7d-42c2-468d-8a3d-bd13d8462eaf",
                    "new": true,
                    "parent_id": null,
                    "created_by": "DemoUser",
                    "created_at": "2023-02-22T00:16:09.350Z",
                    "deprecated": false,
                    "human_deprecated": false,
                    "spatial_type": "point",
                    "spatial_payload": [
                        [
                            889.9149291075896,
                            725.9382819015847
                        ]
                    ],
                    "classification_payloads": [
                        {
                            "class_id": 10,
                            "confidence": 0.71
                        }
                    ],
                    "line_size": 6.831220813875917,
                    "containing_box": {
                        "tlx": 869.4212666659619,
                        "tly": 705.4446194599569,
                        "brx": 910.4085915492174,
                        "bry": 746.4319443432124,
                        "tlz": 0,
                        "brz": 0
                    },
                    "frame": 0,
                    "text_payload": "",
                    "annotation_meta": null
                },
                {
                    "id": "b7ea869e-0daa-4c8f-b422-c0bf18eb4013",
                    "new": true,
                    "parent_id": null,
                    "created_by": "DemoUser",
                    "created_at": "2023-02-22T00:16:09.759Z",
                    "deprecated": false,
                    "human_deprecated": false,
                    "spatial_type": "point",
                    "spatial_payload": [
                        [
                            1183.7064220183486,
                            713.9816513761468
                        ]
                    ],
                    "classification_payloads": [
                        {
                            "class_id": 10,
                            "confidence": 0.71
                        }
                    ],
                    "line_size": 6.831220813875917,
                    "containing_box": {
                        "tlx": 1163.2127595767208,
                        "tly": 693.4879889345191,
                        "brx": 1204.2000844599763,
                        "bry": 734.4753138177746,
                        "tlz": 0,
                        "brz": 0
                    },
                    "frame": 0,
                    "text_payload": "",
                    "annotation_meta": null
                },
                {
                    "id": "16f068d3-7c14-4957-a599-0d91834a73da",
                    "new": true,
                    "parent_id": null,
                    "created_by": "DemoUser",
                    "created_at": "2023-02-22T00:16:10.251Z",
                    "deprecated": false,
                    "human_deprecated": false,
                    "spatial_type": "point",
                    "spatial_payload": [
                        [
                            988.9841534612177,
                            473.1409507923269
                        ]
                    ],
                    "classification_payloads": [
                        {
                            "class_id": 10,
                            "confidence": 0.61
                        }
                    ],
                    "line_size": 6.831220813875917,
                    "containing_box": {
                        "tlx": 968.49049101959,
                        "tly": 452.64728835069917,
                        "brx": 1009.4778159028455,
                        "bry": 493.63461323395467,
                        "tlz": 0,
                        "brz": 0
                    },
                    "frame": 0,
                    "text_payload": "",
                    "annotation_meta": null
                },
                {
                    "id": "50b2e112-7939-44d6-8201-878a174b2762",
                    "new": true,
                    "parent_id": null,
                    "created_by": "DemoUser",
                    "created_at": "2023-02-22T00:16:10.825Z",
                    "deprecated": false,
                    "human_deprecated": false,
                    "spatial_type": "point",
                    "spatial_payload": [
                        [
                            949.698081734779,
                            174.2251876563803
                        ]
                    ],
                    "classification_payloads": [
                        {
                            "class_id": 10,
                            "confidence": 0.51
                        }
                    ],
                    "line_size": 6.831220813875917,
                    "containing_box": {
                        "tlx": 929.2044192931512,
                        "tly": 153.73152521475257,
                        "brx": 970.1917441764067,
                        "bry": 194.71885009800806,
                        "tlz": 0,
                        "brz": 0
                    },
                    "frame": 0,
                    "text_payload": "",
                    "annotation_meta": null
                },
                {
                    "id": "24150a98-fe96-444a-bf86-bf05498dbdf2",
                    "new": true,
                    "parent_id": null,
                    "created_by": "DemoUser",
                    "created_at": "2023-02-22T00:16:11.508Z",
                    "deprecated": false,
                    "human_deprecated": false,
                    "spatial_type": "point",
                    "spatial_payload": [
                        [
                            1105.1342785654713,
                            901.8715596330276
                        ]
                    ],
                    "classification_payloads": [
                        {
                            "class_id": 10,
                            "confidence": 1
                        }
                    ],
                    "line_size": 6.831220813875917,
                    "containing_box": {
                        "tlx": 1084.6406161238435,
                        "tly": 881.3778971913998,
                        "brx": 1125.627941007099,
                        "bry": 922.3652220746553,
                        "tlz": 0,
                        "brz": 0
                    },
                    "frame": 0,
                    "text_payload": "",
                    "annotation_meta": null
                },
                {
                    "id": "490e8825-4113-4551-b848-5864922ba068",
                    "new": true,
                    "parent_id": null,
                    "created_by": "DemoUser",
                    "created_at": "2023-02-22T00:16:12.396Z",
                    "deprecated": false,
                    "human_deprecated": false,
                    "spatial_type": "point",
                    "spatial_payload": [
                        [
                            1410.882402001668,
                            121.2743953294412
                        ]
                    ],
                    "classification_payloads": [
                        {
                            "class_id": 10,
                            "confidence": 0.41
                        }
                    ],
                    "line_size": 6.831220813875917,
                    "containing_box": {
                        "tlx": 1390.3887395600402,
                        "tly": 100.78073288781346,
                        "brx": 1431.3760644432957,
                        "bry": 141.76805777106895,
                        "tlz": 0,
                        "brz": 0
                    },
                    "frame": 0,
                    "text_payload": "",
                    "annotation_meta": null
                },
                {
                    "id": "5d2ca78b-16df-4cc3-b793-1eba195ea0bd",
                    "new": true,
                    "parent_id": null,
                    "created_by": "DemoUser",
                    "created_at": "2023-02-22T00:16:12.688Z",
                    "deprecated": false,
                    "human_deprecated": false,
                    "spatial_type": "point",
                    "spatial_payload": [
                        [
                            1414.2985821517932,
                            397.9849874895746
                        ]
                    ],
                    "classification_payloads": [
                        {
                            "class_id": 10,
                            "confidence": 0.5
                        }
                    ],
                    "line_size": 6.831220813875917,
                    "containing_box": {
                        "tlx": 1393.8049197101654,
                        "tly": 377.4913250479469,
                        "brx": 1434.792244593421,
                        "bry": 418.47864993120237,
                        "tlz": 0,
                        "brz": 0
                    },
                    "frame": 0,
                    "text_payload": "",
                    "annotation_meta": null
                },
                {
                    "id": "e340d844-e99a-4146-8a9f-f22f0583c3ee",
                    "new": true,
                    "parent_id": null,
                    "created_by": "DemoUser",
                    "created_at": "2023-02-22T00:16:13.090Z",
                    "deprecated": false,
                    "human_deprecated": false,
                    "spatial_type": "point",
                    "spatial_payload": [
                        [
                            1620.977481234362,
                            732.7706422018349
                        ]
                    ],
                    "classification_payloads": [
                        {
                            "class_id": 10,
                            "confidence": 1
                        }
                    ],
                    "line_size": 6.831220813875917,
                    "containing_box": {
                        "tlx": 1600.4838187927342,
                        "tly": 712.2769797602072,
                        "brx": 1641.4711436759897,
                        "bry": 753.2643046434627,
                        "tlz": 0,
                        "brz": 0
                    },
                    "frame": 0,
                    "text_payload": "",
                    "annotation_meta": null
                },
                {
                    "id": "620a02b7-8802-47c2-b587-feee846c73ce",
                    "new": true,
                    "parent_id": null,
                    "created_by": "DemoUser",
                    "created_at": "2023-02-22T00:16:13.606Z",
                    "deprecated": false,
                    "human_deprecated": false,
                    "spatial_type": "point",
                    "spatial_payload": [
                        [
                            1557.7781484570476,
                            283.5429524603837
                        ]
                    ],
                    "classification_payloads": [
                        {
                            "class_id": 10,
                            "confidence": 0.91
                        }
                    ],
                    "line_size": 6.831220813875917,
                    "containing_box": {
                        "tlx": 1537.2844860154198,
                        "tly": 263.0492900187559,
                        "brx": 1578.2718108986753,
                        "bry": 304.0366149020114,
                        "tlz": 0,
                        "brz": 0
                    },
                    "frame": 0,
                    "text_payload": "",
                    "annotation_meta": null
                },
                {
                    "id": "fab30cf9-6d5d-4ef1-a809-b805ed90f0a4",
                    "new": true,
                    "parent_id": null,
                    "created_by": "DemoUser",
                    "created_at": "2023-02-22T00:16:14.693Z",
                    "deprecated": false,
                    "human_deprecated": false,
                    "spatial_type": "point",
                    "spatial_payload": [
                        [
                            1909.6447039199334,
                            602.9557964970809
                        ]
                    ],
                    "classification_payloads": [
                        {
                            "class_id": 10,
                            "confidence": 0.21
                        }
                    ],
                    "line_size": 6.831220813875917,
                    "containing_box": {
                        "tlx": 1889.1510414783056,
                        "tly": 582.4621340554531,
                        "brx": 1930.138366361561,
                        "bry": 623.4494589387086,
                        "tlz": 0,
                        "brz": 0
                    },
                    "frame": 0,
                    "text_payload": "",
                    "annotation_meta": null
                },
                {
                    "id": "40de3c5b-6ec1-4b61-802a-fe0df7915044",
                    "new": true,
                    "parent_id": null,
                    "created_by": "DemoUser",
                    "created_at": "2023-02-22T00:16:16.444Z",
                    "deprecated": false,
                    "human_deprecated": false,
                    "spatial_type": "point",
                    "spatial_payload": [
                        [
                            1328.8940783986654,
                            584.1668056713928
                        ]
                    ],
                    "classification_payloads": [
                        {
                            "class_id": 10,
                            "confidence": 0.11
                        }
                    ],
                    "line_size": 6.831220813875917,
                    "containing_box": {
                        "tlx": 1308.4004159570377,
                        "tly": 563.6731432297651,
                        "brx": 1349.3877408402932,
                        "bry": 604.6604681130206,
                        "tlz": 0,
                        "brz": 0
                    },
                    "frame": 0,
                    "text_payload": "",
                    "annotation_meta": null
                }
            ]

            const rows_resume_from = [
                {
                    "id": "23e6c1c9-f48b-4f02-909c-6bd8ee8dede5",
                    "is_new": true,
                    "parent_id": null,
                    "created_by": "DemoUser",
                    "deprecated": false,
                    "spatial_type": "polyline",
                    "spatial_payload": [
                        [
                            271.5863219349458,
                            169.10091743119267
                        ],
                        [
                            597.8315262718933,
                            970.1951626355296
                        ]
                    ],
                    "classification_payloads": [
                        {
                            "class_id": 20,
                            "confidence": 1
                        },
                        {
                            "class_id": 21,
                            "confidence": 0
                        }
                    ],
                    "line_size": 6.831220813875917,
                    "containing_box": {
                        "tlx": 251.09265949331802,
                        "tly": 148.60725498956492,
                        "brx": 618.325188713521,
                        "bry": 990.6888250771574,
                        "tlz": 0,
                        "brz": 0
                    },
                    "frame": 0,
                    "text_payload": "",
                    "annotation_meta": null,
                    "human_deprecated": false,
                    "new": false,
                    "created_at": "2023-02-22T00:15:56.085Z"
                },
                {
                    "id": "96ee0422-31c6-406c-a16a-a4de5fc953e0",
                    "is_new": true,
                    "parent_id": null,
                    "created_by": "DemoUser",
                    "deprecated": false,
                    "spatial_type": "polyline",
                    "spatial_payload": [
                        [
                            1332.3102585487907,
                            126.39866555462886
                        ],
                        [
                            1832.7806505421183,
                            896.7472894078398
                        ]
                    ],
                    "classification_payloads": [
                        {
                            "class_id": 20,
                            "confidence": 1
                        },
                        {
                            "class_id": 21,
                            "confidence": 0
                        }
                    ],
                    "line_size": 6.831220813875917,
                    "containing_box": {
                        "tlx": 1311.816596107163,
                        "tly": 105.90500311300111,
                        "brx": 1853.274312983746,
                        "bry": 917.2409518494676,
                        "tlz": 0,
                        "brz": 0
                    },
                    "frame": 0,
                    "text_payload": "",
                    "annotation_meta": null,
                    "human_deprecated": false,
                    "new": false,
                    "created_at": "2023-02-22T00:16:01.606Z"
                },
                {
                    "id": "35d4a20c-eb6e-4ac9-8dbf-23c80b499336",
                    "is_new": true,
                    "parent_id": "66ebf3bc-1f3c-40ea-9cb2-3aa55cf76f48",
                    "created_by": "DemoUser",
                    "deprecated": false,
                    "spatial_type": "polyline",
                    "spatial_payload": [
                        [
                            896.7472894078398,
                            134.9391159299416
                        ],
                        [
                            813.0508757297748,
                            561.9616346955796
                        ],
                        [
                            1082.929107589658,
                            418.48206839032525
                        ],
                        [
                            1125.6313594662217,
                            939.4495412844037
                        ]
                    ],
                    "classification_payloads": [
                        {
                            "class_id": 20,
                            "confidence": 0
                        },
                        {
                            "class_id": 21,
                            "confidence": 1
                        }
                    ],
                    "line_size": 6.831220813875917,
                    "containing_box": {
                        "tlx": 792.5572132881471,
                        "tly": 114.44545348831386,
                        "brx": 1146.1250219078495,
                        "bry": 959.9432037260315,
                        "tlz": 0,
                        "brz": 0
                    },
                    "frame": 0,
                    "text_payload": "",
                    "annotation_meta": null,
                    "human_deprecated": false,
                    "new": true,
                    "created_at": "2023-02-22T00:15:58.869Z"
                }
            ]

            let subtasks = {
                "plants": {
                    "display_name": "Plants",
                    "classes": [
                        {
                            "name": "Plant",
                            "color": "yellow",
                            "id": 10
                        }
                    ],
                    "allowed_modes": ["point"],
                    "resume_from": points_resume_from,
                    "task_meta": null,
                    "annotation_meta": null
                },
                "rows": {
                    "display_name": "Rows",
                    "classes": [
                        {
                            "name": "Female",
                            "color": "pink",
                            "id": 20
                        },
                        {
                            "name": "Male",
                            "color": "blue",
                            "id": 21
                        }
                    ],
                    "allowed_modes": ["polyline"],
                    "resume_from": rows_resume_from,
                    "task_meta": null,
                    "annotation_meta": null
                }
            };

            // Initial ULabel configuration
            let ulabel = new ULabel({
                "container_id": "container",
                "image_data": "https://ulabel.s3.us-east-2.amazonaws.com/cs-demo-0.png",
                "username": "DemoUser",
                "submit_buttons": on_submit,
                "subtasks": subtasks,
                "toolbox_order": [0, 1, 3, 6, 8, 2, 7]
            });
            // Wait for ULabel instance to finish initialization
            ulabel.init(function () {
                // ULabel is now ready for use
                console.log("ULabel", ulabel);
            });
        });
    </script>
</head>

<body>
    <div id="container" style="width: 100%; height: 100vh; position: absolute; top: 0; left: 0;"></div>
</body>

</html>